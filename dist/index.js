'use strict';var _Promise='undefined'==typeof Promise?require('es6-promise').Promise:Promise,fetch=require('axios'),weekdays=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];function busy_hours(a,b){var c=require('@google/maps').createClient({key:b,Promise:_Promise}),d=function(a){return{hour:a[0],percentage:a[1]}},e=function(a){var b=['APP_INITIALIZATION_STATE=','window.APP_FLAGS'],c=a.substring(a.lastIndexOf(b[0])+b[0].length,a.lastIndexOf(b[1])),d=eval(c),e=eval(d[3][6].replace(')]}\'',''));return e[0][1][0][14][84]},f=function(a){if(a.data){var b=e(a.data);if(null===b)return{status:'error',message:'Place has no popular hours'};var c={status:'ok',week:Array.from(Array(7).keys()).map(function(a){var c=[];return b[0][a]&&b[0][a][1]&&(c=Array.from(b[0][a][1]).map(function(a){return d(a)})),{day:weekdays[a],hours:c}})},f=b[7];return void 0!==f&&(c.now=d(f)),c}return{status:'error'}},g=function(a){var b=a.json.result.url;return console.log(b),b?fetch({url:b,headers:{"User-Agent":'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36'}}):{status:'error',message:'Invalid url'}},h=function(a){return{status:'error',message:a}},i=c.place({placeid:a},h).asPromise().then(g).then(f);return i}module.exports=busy_hours;